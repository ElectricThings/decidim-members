From 1017da9cdc385c71ee1df2d4bb6272b38a13367f Mon Sep 17 00:00:00 2001
From: Jens Kraemer <jk@jkraemer.net>
Date: Mon, 18 Sep 2017 13:45:12 +0800
Subject: [PATCH] User profile extensions

- allow for extension of the account editing form
- link to public user profiles if members plugin is present
---
 .../assets/javascripts/decidim/comments/bundle.js  | Bin 870010 -> 870153 bytes
 .../frontend/comments/comment.component.test.tsx   |   1 +
 .../app/frontend/comments/comment.component.tsx    |   2 +-
 .../fragments/comment_data.fragment.graphql        |   1 +
 .../app/frontend/support/generate_comments_data.ts |   1 +
 decidim-comments/app/frontend/support/schema.ts    | 100 +++++++++++++++++++++
 .../_account_form_additional_attributes.html.erb   |   1 +
 .../app/views/decidim/account/show.html.erb        |   1 +
 .../app/views/layouts/decidim/_user_menu.html.erb  |   3 +
 decidim-core/config/locales/en.yml                 |   1 +
 .../lib/decidim/core/api/author_interface.rb       |   2 +
 .../lib/decidim/core/api/user_group_type.rb        |   4 +
 decidim-core/lib/decidim/core/api/user_type.rb     |   4 +
 .../decidim/proposals/proposals/_author.html.erb   |  14 +--
 .../proposals/proposals/_linked_proposals.html.erb |  16 +++-
 15 files changed, 142 insertions(+), 9 deletions(-)
 create mode 100644 decidim-core/app/views/decidim/account/_account_form_additional_attributes.html.erb

diff --git a/decidim-comments/app/assets/javascripts/decidim/comments/bundle.js b/decidim-comments/app/assets/javascripts/decidim/comments/bundle.js
index 38fbbb63db3914138cc347807c90aad2a31910ce..4ba838eaa97fc108164db65bbcd8caa10188a3b3 100644
GIT binary patch
delta 100
zcmey>W7^qg+R(z-!qmdt!qURp!q&px!qLLn!qvjPg(va@dqGitT4qk_^mCgT)3!%`
u;AvxKvM}8K@G}n+BTR1ltuH*c6@_#%ic-_867`@uLW^>?Zx!P`st*8Yzb0q^

delta 60
zcmeC|GyT<L+R(z-!qmdt!qURp!q&px!qLLn!qvjPg(vdE_G2G-+L)Ql%(nY|;bCIj
Qp753DlHzt3ao(f)0H7Hb6#xJL

diff --git a/decidim-comments/app/frontend/comments/comment.component.test.tsx b/decidim-comments/app/frontend/comments/comment.component.test.tsx
index 539bdfa..a795317 100644
--- a/decidim-comments/app/frontend/comments/comment.component.test.tsx
+++ b/decidim-comments/app/frontend/comments/comment.component.test.tsx
@@ -48,6 +48,7 @@ describe("<Comment />", () => {
   it("should render author's name in a link with class author__name", () => {
     const wrapper = shallow(<Comment comment={comment} session={session} rootCommentable={rootCommentable} orderBy={orderBy} />);
     expect(wrapper.find("a.author__name").text()).toEqual(comment.author.name);
+    expect(wrapper.find("a.author__name").prop("href")).toEqual(comment.author.profileUrl);
   });
 
   describe("when the author's account has been deleted", () => {
diff --git a/decidim-comments/app/frontend/comments/comment.component.tsx b/decidim-comments/app/frontend/comments/comment.component.tsx
index 687043e..102b648 100644
--- a/decidim-comments/app/frontend/comments/comment.component.tsx
+++ b/decidim-comments/app/frontend/comments/comment.component.tsx
@@ -107,7 +107,7 @@ class Comment extends React.Component<CommentProps, CommentState> {
                 </a>
                 { author.deleted ?
                     <span className="label label--small label--basic">{I18n.t("components.comment.deleted_user")}</span> :
-                    <a className="author__name">{author.name}</a>
+                    <a className="author__name" href={author.profileUrl}>{author.name}</a>
                 }
                 { !author.isUser && author.isVerified &&
                   <span>
diff --git a/decidim-comments/app/frontend/fragments/comment_data.fragment.graphql b/decidim-comments/app/frontend/fragments/comment_data.fragment.graphql
index c6f4f88..92a8ef3 100644
--- a/decidim-comments/app/frontend/fragments/comment_data.fragment.graphql
+++ b/decidim-comments/app/frontend/fragments/comment_data.fragment.graphql
@@ -10,6 +10,7 @@ fragment CommentData on Comment {
   author {
     name
     avatarUrl
+    profileUrl
     isVerified
     isUser
     deleted
diff --git a/decidim-comments/app/frontend/support/generate_comments_data.ts b/decidim-comments/app/frontend/support/generate_comments_data.ts
index aeb3663..8f2e642 100644
--- a/decidim-comments/app/frontend/support/generate_comments_data.ts
+++ b/decidim-comments/app/frontend/support/generate_comments_data.ts
@@ -19,6 +19,7 @@ const generateCommentsData = (num = 1) => {
       author: {
         name: name.findName(),
         avatarUrl: image.imageUrl(),
+        profileUrl: "/members/"+random.uuid(),
         isVerified: Math.random() >= 0.5,
         isUser: Math.random() >= 0.5,
         deleted: false,
diff --git a/decidim-comments/app/frontend/support/schema.ts b/decidim-comments/app/frontend/support/schema.ts
index 7842b76..3c48d2e 100644
--- a/decidim-comments/app/frontend/support/schema.ts
+++ b/decidim-comments/app/frontend/support/schema.ts
@@ -32,6 +32,8 @@ export type addCommentMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -43,6 +45,8 @@ export type addCommentMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -82,6 +86,8 @@ export type addCommentMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -93,6 +99,8 @@ export type addCommentMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -134,6 +142,8 @@ export type addCommentMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -145,6 +155,8 @@ export type addCommentMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -186,6 +198,8 @@ export type addCommentMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -197,6 +211,8 @@ export type addCommentMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -252,6 +268,8 @@ export type DownVoteMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -263,6 +281,8 @@ export type DownVoteMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -304,6 +324,8 @@ export type DownVoteMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -315,6 +337,8 @@ export type DownVoteMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -356,6 +380,8 @@ export type DownVoteMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -367,6 +393,8 @@ export type DownVoteMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -408,6 +436,8 @@ export type DownVoteMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -419,6 +449,8 @@ export type DownVoteMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -474,6 +506,8 @@ export type UpVoteMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -485,6 +519,8 @@ export type UpVoteMutation = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -526,6 +562,8 @@ export type UpVoteMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -537,6 +575,8 @@ export type UpVoteMutation = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -578,6 +618,8 @@ export type UpVoteMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -589,6 +631,8 @@ export type UpVoteMutation = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -630,6 +674,8 @@ export type UpVoteMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -641,6 +687,8 @@ export type UpVoteMutation = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -724,6 +772,8 @@ export type GetCommentsQuery = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -735,6 +785,8 @@ export type GetCommentsQuery = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -774,6 +826,8 @@ export type GetCommentsQuery = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -785,6 +839,8 @@ export type GetCommentsQuery = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -826,6 +882,8 @@ export type GetCommentsQuery = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -837,6 +895,8 @@ export type GetCommentsQuery = {
               name: string,
               // The author's avatar url
               avatarUrl: string,
+              // The user's profile url
+              profileUrl: string,
               // Whether the author is verified or not
               isVerified: boolean,
               // Whether the author is a user or another kind of author (User Group)
@@ -878,6 +938,8 @@ export type GetCommentsQuery = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -889,6 +951,8 @@ export type GetCommentsQuery = {
                 name: string,
                 // The author's avatar url
                 avatarUrl: string,
+                // The user's profile url
+                profileUrl: string,
                 // Whether the author is verified or not
                 isVerified: boolean,
                 // Whether the author is a user or another kind of author (User Group)
@@ -958,6 +1022,8 @@ export type CommentFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -969,6 +1035,8 @@ export type CommentFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -1010,6 +1078,8 @@ export type CommentFragment = {
         name: string,
         // The author's avatar url
         avatarUrl: string,
+        // The user's profile url
+        profileUrl: string,
         // Whether the author is verified or not
         isVerified: boolean,
         // Whether the author is a user or another kind of author (User Group)
@@ -1021,6 +1091,8 @@ export type CommentFragment = {
         name: string,
         // The author's avatar url
         avatarUrl: string,
+        // The user's profile url
+        profileUrl: string,
         // Whether the author is verified or not
         isVerified: boolean,
         // Whether the author is a user or another kind of author (User Group)
@@ -1062,6 +1134,8 @@ export type CommentFragment = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -1073,6 +1147,8 @@ export type CommentFragment = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -1114,6 +1190,8 @@ export type CommentFragment = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -1125,6 +1203,8 @@ export type CommentFragment = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -1171,6 +1251,8 @@ export type CommentDataFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -1182,6 +1264,8 @@ export type CommentDataFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -1227,6 +1311,8 @@ export type CommentThreadFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -1238,6 +1324,8 @@ export type CommentThreadFragment = {
       name: string,
       // The author's avatar url
       avatarUrl: string,
+      // The user's profile url
+      profileUrl: string,
       // Whether the author is verified or not
       isVerified: boolean,
       // Whether the author is a user or another kind of author (User Group)
@@ -1277,6 +1365,8 @@ export type CommentThreadFragment = {
         name: string,
         // The author's avatar url
         avatarUrl: string,
+        // The user's profile url
+        profileUrl: string,
         // Whether the author is verified or not
         isVerified: boolean,
         // Whether the author is a user or another kind of author (User Group)
@@ -1288,6 +1378,8 @@ export type CommentThreadFragment = {
         name: string,
         // The author's avatar url
         avatarUrl: string,
+        // The user's profile url
+        profileUrl: string,
         // Whether the author is verified or not
         isVerified: boolean,
         // Whether the author is a user or another kind of author (User Group)
@@ -1329,6 +1421,8 @@ export type CommentThreadFragment = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -1340,6 +1434,8 @@ export type CommentThreadFragment = {
           name: string,
           // The author's avatar url
           avatarUrl: string,
+          // The user's profile url
+          profileUrl: string,
           // Whether the author is verified or not
           isVerified: boolean,
           // Whether the author is a user or another kind of author (User Group)
@@ -1381,6 +1477,8 @@ export type CommentThreadFragment = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
@@ -1392,6 +1490,8 @@ export type CommentThreadFragment = {
             name: string,
             // The author's avatar url
             avatarUrl: string,
+            // The user's profile url
+            profileUrl: string,
             // Whether the author is verified or not
             isVerified: boolean,
             // Whether the author is a user or another kind of author (User Group)
diff --git a/decidim-core/app/views/decidim/account/_account_form_additional_attributes.html.erb b/decidim-core/app/views/decidim/account/_account_form_additional_attributes.html.erb
new file mode 100644
index 0000000..58b08ac
--- /dev/null
+++ b/decidim-core/app/views/decidim/account/_account_form_additional_attributes.html.erb
@@ -0,0 +1 @@
+<%# override this file in your app to extend the user account form %>
diff --git a/decidim-core/app/views/decidim/account/show.html.erb b/decidim-core/app/views/decidim/account/show.html.erb
index f9748fa..130d3f0 100644
--- a/decidim-core/app/views/decidim/account/show.html.erb
+++ b/decidim-core/app/views/decidim/account/show.html.erb
@@ -7,6 +7,7 @@
     <div class="columns large-8 end">
       <%= f.text_field :name %>
       <%= f.email_field :email %>
+      <%= render partial: 'account_form_additional_attributes', locals: { form: f } %>
 
       <% if @account.errors[:password].any? || @account.errors[:password_confirmation].any? %>
         <%= render partial: "password_fields", locals: { form: f } %>
diff --git a/decidim-core/app/views/layouts/decidim/_user_menu.html.erb b/decidim-core/app/views/layouts/decidim/_user_menu.html.erb
index f605dbe..1e5e871 100644
--- a/decidim-core/app/views/layouts/decidim/_user_menu.html.erb
+++ b/decidim-core/app/views/layouts/decidim/_user_menu.html.erb
@@ -1,4 +1,7 @@
 <li><%= link_to t(".profile"), decidim.account_path %></li>
+<% if defined?(decidim_members) %>
+<li><%= link_to t(".public_profile"), decidim_members.member_path(current_user) %></li>
+<% end %>
 <li><%= link_to t(".notifications"), decidim.notifications_path %></li>
 <% if can? :read, :admin_dashboard %>
   <li><%= link_to t(".admin_dashboard"), decidim_admin.root_path %></li>
diff --git a/decidim-core/config/locales/en.yml b/decidim-core/config/locales/en.yml
index 24077d3..7ff58ad 100644
--- a/decidim-core/config/locales/en.yml
+++ b/decidim-core/config/locales/en.yml
@@ -323,6 +323,7 @@ en:
         admin_dashboard: Admin dashboard
         notifications: Notifications
         profile: My account
+        public_profile: My public profile
         sign_out: Sign out
       user_profile:
         account: Account
diff --git a/decidim-core/lib/decidim/core/api/author_interface.rb b/decidim-core/lib/decidim/core/api/author_interface.rb
index 608c849..2574dbe 100644
--- a/decidim-core/lib/decidim/core/api/author_interface.rb
+++ b/decidim-core/lib/decidim/core/api/author_interface.rb
@@ -10,6 +10,8 @@ module Decidim
 
     field :avatarUrl, !types.String, "The author's avatar url"
 
+    field :profileUrl, !types.String, "The user's profile url"
+
     field :isVerified, !types.Boolean, "Whether the author is verified or not"
 
     field :deleted, !types.Boolean, "Whether the author's account has been deleted or not"
diff --git a/decidim-core/lib/decidim/core/api/user_group_type.rb b/decidim-core/lib/decidim/core/api/user_group_type.rb
index 4c06fa9..12ac275 100644
--- a/decidim-core/lib/decidim/core/api/user_group_type.rb
+++ b/decidim-core/lib/decidim/core/api/user_group_type.rb
@@ -14,6 +14,10 @@ module Decidim
 
     field :name, !types.String, "The user group's name"
 
+    field :profileUrl, !types.String, "The user's profile url" do
+      resolve ->(obj, _args, _ctx) { "/members/#{obj.id}" }
+    end
+
     field :avatarUrl, !types.String, "The user's avatar url" do
       resolve ->(obj, _args, _ctx) { obj.avatar.url }
     end
diff --git a/decidim-core/lib/decidim/core/api/user_type.rb b/decidim-core/lib/decidim/core/api/user_type.rb
index a715759..153fb0d 100644
--- a/decidim-core/lib/decidim/core/api/user_type.rb
+++ b/decidim-core/lib/decidim/core/api/user_type.rb
@@ -12,6 +12,10 @@ module Decidim
 
     field :name, !types.String, "The user's name"
 
+    field :profileUrl, !types.String, "The user's profile url" do
+      resolve ->(obj, _args, _ctx) { "/members/#{obj.id}" }
+    end
+
     field :avatarUrl, !types.String, "The user's avatar url" do
       resolve ->(obj, _args, _ctx) { obj.avatar.url }
     end
diff --git a/decidim-proposals/app/views/decidim/proposals/proposals/_author.html.erb b/decidim-proposals/app/views/decidim/proposals/proposals/_author.html.erb
index b85cd37..3c39183 100644
--- a/decidim-proposals/app/views/decidim/proposals/proposals/_author.html.erb
+++ b/decidim-proposals/app/views/decidim/proposals/proposals/_author.html.erb
@@ -3,15 +3,19 @@
     <span class="author__avatar author__avatar--small">
       <%= image_tag proposal.author_avatar_url %>
     </span>
-    <span class="author__name">
-      <% if proposal.author&.deleted? %>
+    <% if proposal.author&.deleted? %>
+      <span class="author__name">
         <span class="label label--small label--basic">
           <%= t('.deleted') %>
         </span>
-      <% else %>
+      </span>
+    <% elsif proposal.author and defined?(decidim_members) %>
+      <%= link_to proposal.author_name, decidim_members.member_path(proposal.author), class: 'author__name' %>
+    <% else %>
+      <span class="author__name">
         <%= proposal.author_name %>
-      <% end %>
-    </span>
+      </span>
+    <% end %>
     <% if proposal.user_group && proposal.user_group.verified? %>
       &nbsp;
       <span class="label label--highlight label--small">
diff --git a/decidim-proposals/app/views/decidim/proposals/proposals/_linked_proposals.html.erb b/decidim-proposals/app/views/decidim/proposals/proposals/_linked_proposals.html.erb
index 1a35fcc..908c7e3 100644
--- a/decidim-proposals/app/views/decidim/proposals/proposals/_linked_proposals.html.erb
+++ b/decidim-proposals/app/views/decidim/proposals/proposals/_linked_proposals.html.erb
@@ -13,9 +13,19 @@
             <span class="author__avatar">
               <%= image_tag proposal.author_avatar_url %>
             </span>
-            <span class="author__name">
-              <%= proposal.author_name %>
-            </span>
+            <% if proposal.author&.deleted? %>
+              <span class="author__name">
+                <span class="label label--small label--basic">
+                  <%= t('.deleted') %>
+                </span>
+              </span>
+            <% elsif proposal.author and defined?(decidim_members) %>
+              <%= link_to proposal.author_name, decidim_members.member_path(proposal.author), class: 'author__name' %>
+            <% else %>
+              <span class="author__name">
+                <%= proposal.author_name %>
+              </span>
+            <% end %>
           </div>
         </div>
       </div>
-- 
2.1.4

